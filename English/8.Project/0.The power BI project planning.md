# **Intensive and Advanced Plan for the Power BI Mini-Project: Sales and Promotions Analysis**  

> **Note:** This project is using data from **Sources\Final Project** folder

**Objective: Create a complete Power BI application with advanced analytics, maximized interactivity, and refined ergonomics.**  

---

## **Step 1: Data Import & Transformation (Power Query Editor & M)**  
**Objective: Clean, transform, and optimize data for modeling and improve performance.**  

### **1.1. Advanced Optimizations in Power Query**  
**DimProduct**:  
- Remove the unnecessary column **Column1**.  
- Add a **"Product Type"** column by automatically classifying products.  
- Clean product names by removing special characters.  
- Handle missing values in `Manufacturer` by replacing them with `"Unknown"`.  

**DimPromotion**:  
- Convert **StartDate** and **EndDate** to date format and create a **calculated column for promotion duration duration.days(enddate _ startdate)**.  

**FactSales**:  
- Filter out outliers (`UnitPrice > 0`).  
- Add a `Revenue` column = `[UnitPrice] * [SalesQuantity]`.  
- Add a marker column **IsReturned** (`1` if `ReturnQuantity` > `0`, otherwise `0`).  

**DimDate (automatically generated with Power Query M)**  
- Add **Quarter** column  

---

Then add the other dimensions tables 
- DimChannel **(Remove unecessary raws and configure the columns headers)**
- DimProductPromotion

**The model should look like this:** 
![The model](https://github.com/bejaouibechir/PowerBI/blob/main/English/8.Project/img/1.png)


## **Step 2: Creating Calculated Tables and Columns (DAX)**  
**Objective: Enhance the model by creating simplified tables, calculated columns, and advanced measures.**  

### **2.1. Calculated Tables to Simplify the Model**  
**Aggregated Products-Promotions Table**  

Before proceeding and creating the TableProductPromo, you need to feel the **CategoryKey** in **DimProduct**

![The DimProductTable](https://github.com/bejaouibechir/PowerBI/blob/main/English/8.Project/img/2.png)

**And the model should be modified like below** 
![The DimProductTable](https://github.com/bejaouibechir/PowerBI/blob/main/English/8.Project/img/3.png)


```DAX
TableProductPromo = 
SELECTCOLUMNS(
    NATURALINNERJOIN(DimProductPromotion, DimPromotion),
    "ProductKey", [ProductKey],
    "Promotion", [PromotionLabel],
    "DiscountPercent", [DiscountPercent],
    "Category", RELATED(DimCategory[CategoryName])
)
```
**Aggregated Sales Table by Month and Channel**  
```DAX
SalesByMonth = 
SUMMARIZE(
    FactSales, 
    DimDate[YYYYMM], DimChannel[ChannelName],
    "Total Sales", SUM(FactSales[SalesQuantity] * FactSales[UnitPrice])
)
```

---

### **2.2. Calculated Columns in DAX**  
**Profit Margin**  
```DAX
ProfitMargin = DIVIDE(([Total Sales] - [Total Cost]), [Total Sales], 0)
```
**Promotion Classification**  
```DAX
DiscountCategory = 
SWITCH(TRUE(),
    [DiscountPercent] >= 50, "Very High",
    [DiscountPercent] >= 30, "High",
    [DiscountPercent] >= 10, "Moderate",
    "Low"
)
```

**Product Status (Price Range Based on Unit Price)**  
```DAX
PriceCategory = 
IF([UnitPrice] > 400, "Premium",
    IF([UnitPrice] > 200, "Mid-Range", "Entry-Level")
)
```

---

### **2.3. Advanced Measures in DAX**  
**Sales After Discount**  
```DAX
NetSales = [Total Sales] - SUM(FactSales[DiscountAmount])
```
**Yearly Sales Growth**  
```DAX
SalesGrowth = 
VAR PreviousYearSales = 
    CALCULATE([Total Sales], SAMEPERIODLASTYEAR(DimDate[DateKey]))
RETURN 
    DIVIDE([Total Sales] - PreviousYearSales, PreviousYearSales, 0)
```
**Return Rate**  
```DAX
ReturnRate = DIVIDE(SUM(FactSales[ReturnQuantity]), SUM(FactSales[SalesQuantity]), 0)
```
**Sales Channel Performance Index**  
```DAX
ChannelPerformanceIndex = 
RANKX(ALL(DimChannel), [Total Sales], , DESC, DENSE)
```

---

## **Step 3: Report and Visualization Creation**  
**Objective: Build 3 interactive reports, organized by pages with advanced UX features.**  

### **Report 1: Sales Overview**  
**Page 1: Global Dashboard**  
**Interactive KPI Cards**:  
- **Total Sales**, **Profit**, **Discounts Applied**, **Return Rate**  
- **Gauge KPI** for **annual sales growth**  
**Advanced Charts**:  
- **Sales Geographic Map**  
- **Heatmap of Sales by Day and Channel**  
**Interactivity**:  
- **Dynamic Slicer** for year/month  
- **Navigation Buttons** between pages  

**Page 2: Sales Analysis by Category**  
**Donut Chart**: Sales distribution by category  
**Bar Chart with Drillthrough**: Best-selling products  

**Page 3: Sales Evolution**  
**Line Chart**: Monthly sales  
**Dynamic Slicer** to filter by sales channel  

---

### **Report 2: Promotions Impact**  
**Page 1: Promotions Overview**  
**Advanced Histogram**: Number of sales per promotion  
**Discounts Heatmap**  

**Page 2: Comparison With and Without Promotion**  
**Stacked Column Chart**: Sales with and without promotion  
**Toggle Button** to filter only promoted products  

**Page 3: Detailed Product Analysis**  
**Dynamic Table** of sales per product and promotion  
**Drillthrough to view transactions of a specific product**  

**Advanced Interactivity**:  
- **Cross-report Drillthrough**: Click on the global report to analyze a productâ€™s promotion  
- **Grouping and Bins to segment discounts into ranges**  

---

### **Report 3: Distribution Channels Analysis**  
**Page 1: Sales by Channel**  
**Stacked Column Chart**: Comparison between Online, Reseller, Store  
**Interactive Map**: Sales distribution  

**Page 2: Channel Performance**  
**Ranking of channels by sales (RANKX)**  
**Conditional Filtering**: Hide underperforming channels  

**Page 3: Yearly Comparison**  
**Line Chart**: Sales evolution by channel  
**Navigation Buttons** to compare different periods  

---

## **Step 4: Publishing, Optimization, and Security**  
**Objective: Ensure an efficient and secure deployment on Power BI Service.**  

**Optimization with DAX Studio**  
**Row-Level Security (RLS) by Sales Channel**  
**Scheduled Refresh on Power BI Service**  
**Creating a Power BI Application with Reports and Dashboards**  

---

## **Final Summary: Why is This Plan Ultra-Intensive?**  
**Advanced Use of Power Query & Power Query M**  
**Creation of Many DAX Measures and Calculated Tables**  
**Ultra-Interactive Reports (Drillthrough, Cross-report, Buttons, KPIs, Slicers, Filters, Grouping, Bins, Gauges)**  
**Optimized and Refined User Experience**  

